{% extends "base.html" %}

{% block title %}My Watchlist{% endblock %}

{% block content %}
<section class="section" style="background-color: #000; min-height: 100vh;">
  <div class="container is-fluid" style="padding: 2rem;">
    <h1 class="title has-text-centered mb-5 mt-5 has-text-white">My Watchlist</h1>
    
    {% if movies %}
    <div class="columns is-multiline is-variable is-2">
      {% for movie in movies %}
      <div class="column is-one-quarter-desktop is-one-third-tablet is-half-mobile">
        <div class="card" style="height: 100%; display: flex; flex-direction: column;">
          <div class="card-image">
            <figure class="image is-2by3" style="max-height: 200px; overflow: hidden;">
              <img src="{{ movie.poster.url }}" alt="{{ movie.title }}" style="object-fit: cover; width: 100%; height: 100%;">
            </figure>
          </div>
          <div class="card-content" style="padding: 1rem;">
            <div class="media">
              <div class="media-content">
                <p class="title is-6 mb-1">{{ movie.title|truncatechars:25 }}</p>
                <p class="subtitle is-7 mt-3">{{ movie.year }}</p>
              </div>
            </div>
          </div>
          <footer class="card-footer" style="border-top: none; padding: 0 0.5rem 0.5rem;">
            <div class="buttons is-flex is-justify-content-space-between" style="width: 100%;">
              <a href="{% url 'movie_details' movie.imdbID %}" class="button is-small is-info">
                <span class="icon is-small">
                  <i class="fas fa-info-circle"></i>
                </span>
                <span>Details</span>
              </a>
              <a href="{% url 'add-watched' movie.imdbID %}" class="button is-small is-success">
                <span class="icon is-small">
                  <i class="fas fa-check"></i>
                </span>
                <span>Watched</span>
              </a>
            </div>
          </footer>
        </div>
      </div>
      {% endfor %}
    </div>
    {% else %}
    <div class="notification is-warning is-light has-text-centered">
      <button class="delete"></button>
      Your watchlist is empty. Add some movies to get started!
    </div>
    {% endif %}
  </div>
</section>

<style>
  /* Consistent card styling */
  .card {
    border-radius: 6px;
    box-shadow: 0 2px 3px rgba(10,10,10,0.1);
    transition: transform 0.2s;
    border: 1px solid #f5f5f5;
    background-color: #fff;
  }
  
  .card:hover {
    transform: translateY(-5px);
    box-shadow: 0 5px 10px rgba(10,10,10,0.1);
  }
  
  /* Make sure the body has black background */
  body {
    background-color: #000 !important;
  }
  
  /* Responsive adjustments */
  @media screen and (max-width: 768px) {
    .column.is-one-quarter-desktop.is-one-third-tablet.is-half-mobile {
      padding: 0.5rem;
    }
    
    .card-content {
      padding: 0.75rem !important;
    }
    
    .buttons .button {
      font-size: 0.75rem;
      padding-left: 0.5em;
      padding-right: 0.5em;
    }
  }
  
  @media screen and (max-width: 480px) {
    .column.is-one-quarter-desktop.is-one-third-tablet.is-half-mobile {
      width: 100%;
    }
  }
</style>

<script>
  // Close notification when X is clicked
  document.addEventListener('DOMContentLoaded', () => {
    (document.querySelectorAll('.notification .delete') || []).forEach(($delete) => {
      $notification = $delete.parentNode;
      $delete.addEventListener('click', () => {
        $notification.parentNode.removeChild($notification);
      });
    });
  });
</script>
{% endblock %}